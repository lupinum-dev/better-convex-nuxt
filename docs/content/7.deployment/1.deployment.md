---
title: Deployment
description: Deploy your Convex + Nuxt application to production.
navigation:
  icon: i-lucide-rocket
---

# Deployment

Deploy your Convex + Nuxt application to production. This guide covers Vercel deployment with CI/CD.

::callout{icon="i-lucide-info"}
**Other Platforms**: Documentation for Netlify, Cloudflare Pages, and other platforms is coming soon. [Contribute on GitHub](https://github.com/your-repo) if you'd like to help!
::

---

## Vercel Deployment

### Prerequisites

Before deploying:

1. Your Convex project is set up and working locally
2. You have a [Vercel account](https://vercel.com)
3. Your code is in a Git repository (GitHub, GitLab, or Bitbucket)

### Step 1: Get Your Convex Deploy Key

Generate a deploy key for CI/CD:

```bash
npx convex deploy --cmd-url-env-var-name CONVEX_URL --save-prod-url
```

Copy the deploy key from the output. You'll add this to Vercel.

### Step 2: Configure Vercel

1. Import your repository in Vercel
2. Add environment variables:

| Variable            | Value                           | Description                |
| ------------------- | ------------------------------- | -------------------------- |
| `CONVEX_DEPLOY_KEY` | `prod:...`                      | Deploy key from Step 1     |
| `CONVEX_URL`        | `https://your-app.convex.cloud` | Your Convex deployment URL |

::callout{icon="i-lucide-lightbulb"}
Find your `CONVEX_URL` in the [Convex dashboard](https://dashboard.convex.dev) under your project settings.
::

### Step 3: Configure Build Settings

In Vercel project settings:

| Setting          | Value                                     |
| ---------------- | ----------------------------------------- |
| Framework Preset | Nuxt.js                                   |
| Build Command    | `npx convex deploy --cmd 'npm run build'` |
| Output Directory | `.output`                                 |
| Install Command  | `npm install` (or `pnpm install`)         |

This ensures Convex functions are deployed before building your Nuxt app.

### Step 4: Configure Auth Callbacks (If Using Auth)

If you're using Better Auth, configure the allowed callback URLs in your Convex auth config:

```ts [convex/auth.ts]
export const createAuth = (ctx: GenericCtx<DataModel>) => {
  return betterAuth({
    baseURL: process.env.SITE_URL,
    // ... other config
    trustedOrigins: [
      process.env.SITE_URL!,
      // Add your Vercel URLs
      'https://your-app.vercel.app',
      'https://your-app-*.vercel.app', // Preview deployments
    ],
  })
}
```

Add `SITE_URL` to your Vercel environment variables:

- **Production**: `https://your-app.vercel.app` (or your custom domain)
- **Preview**: Leave unset or use `VERCEL_URL`

---

## GitHub Actions CI/CD

For more control over your deployment pipeline, use GitHub Actions.

### Basic Workflow

```yaml [.github/workflows/deploy.yml]
name: Deploy

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

env:
  CONVEX_DEPLOY_KEY: ${{ secrets.CONVEX_DEPLOY_KEY }}

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Deploy Convex (Preview)
        if: github.event_name == 'pull_request'
        run: npx convex deploy --preview "${{ github.head_ref }}"

      - name: Deploy Convex (Production)
        if: github.ref == 'refs/heads/main'
        run: npx convex deploy

      - name: Build Nuxt
        run: npm run build
        env:
          CONVEX_URL: ${{ secrets.CONVEX_URL }}
```

### With Vercel Deployment

```yaml [.github/workflows/deploy.yml]
name: Deploy to Vercel

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

env:
  VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
  VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
  CONVEX_DEPLOY_KEY: ${{ secrets.CONVEX_DEPLOY_KEY }}

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install Vercel CLI
        run: npm i -g vercel

      - name: Install dependencies
        run: npm ci

      # Deploy Convex first
      - name: Deploy Convex (Preview)
        if: github.event_name == 'pull_request'
        run: npx convex deploy --preview "${{ github.head_ref }}"

      - name: Deploy Convex (Production)
        if: github.ref == 'refs/heads/main'
        run: npx convex deploy

      # Then deploy to Vercel
      - name: Pull Vercel Environment
        run: vercel pull --yes --token=${{ secrets.VERCEL_TOKEN }}

      - name: Build
        run: vercel build --token=${{ secrets.VERCEL_TOKEN }}
        env:
          CONVEX_URL: ${{ secrets.CONVEX_URL }}

      - name: Deploy Preview
        if: github.event_name == 'pull_request'
        run: vercel deploy --prebuilt --token=${{ secrets.VERCEL_TOKEN }}

      - name: Deploy Production
        if: github.ref == 'refs/heads/main'
        run: vercel deploy --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}
```

### Required Secrets

Add these secrets to your GitHub repository (Settings > Secrets > Actions):

| Secret              | Description                    |
| ------------------- | ------------------------------ |
| `CONVEX_DEPLOY_KEY` | Convex deploy key (`prod:...`) |
| `CONVEX_URL`        | Your Convex deployment URL     |
| `VERCEL_TOKEN`      | Vercel access token            |
| `VERCEL_ORG_ID`     | Vercel organization ID         |
| `VERCEL_PROJECT_ID` | Vercel project ID              |

Get Vercel IDs by running `vercel link` locally.

---

## Preview Deployments

Convex supports preview deployments that match your Git workflow:

```bash
# Deploy a preview environment for a branch
npx convex deploy --preview "feature-branch"
```

This creates an isolated Convex deployment for testing.

### Preview URLs

Your preview deployment gets a unique URL:

```
https://your-app-feature-branch.convex.cloud
```

Configure your Nuxt app to use the preview URL:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  convex: {
    url: process.env.CONVEX_URL, // Set per-environment
  },
})
```

---

## Environment Variables Summary

| Variable            | Required | Description                                 |
| ------------------- | -------- | ------------------------------------------- |
| `CONVEX_URL`        | Yes      | Convex deployment URL (WebSocket)           |
| `CONVEX_DEPLOY_KEY` | CI/CD    | Deploy key for automated deployments        |
| `SITE_URL`          | Auth     | Your app's public URL (for OAuth callbacks) |

---

## Troubleshooting

### Build Fails: "CONVEX_URL not set"

Ensure `CONVEX_URL` is set in your environment variables. The build requires this to generate the Convex client.

### Auth Redirects to Wrong URL

Check your `trustedOrigins` in the auth config includes your production and preview URLs.

### Functions Not Updating

Make sure `npx convex deploy` runs before `npm run build`. The build command should be:

```bash
npx convex deploy --cmd 'npm run build'
```

### Preview Deployment Uses Wrong Database

Each preview deployment (`--preview "branch"`) gets its own isolated database. This is intentional for testing.

---

## Related Topics

- [Installation](/getting-started/installation) - Initial setup
- [Authentication](/auth-security/authentication) - Auth configuration

---
title: useConvexAction
description: Run server actions for external APIs and long-running tasks.
navigation:
  icon: i-lucide-play
---

Execute Convex actions for operations that need external APIs, long-running processes, or non-deterministic behavior.

## Signature

```ts
function useConvexAction<Action>(
  action: Action
): UseConvexActionReturn<Action>
```

## Parameters

### action

The Convex action function reference from your generated API.

```ts
import { api } from '~~/convex/_generated/api'

const { execute } = useConvexAction(api.ai.generateSummary)
```

## Return Value

| Property | Type | Description |
|----------|------|-------------|
| `execute` | `(args) => Promise<Result>` | Run the action |
| `data` | `Ref<Result \| undefined>` | Last action result |
| `status` | `ComputedRef<ActionStatus>` | Current status |
| `pending` | `ComputedRef<boolean>` | True while action is running |
| `error` | `Ref<Error \| null>` | Error if action failed |
| `reset` | `() => void` | Clear data and error |

### status

| Value | Meaning |
|-------|---------|
| `'idle'` | No action in progress |
| `'pending'` | Action running |
| `'success'` | Action completed |
| `'error'` | Action failed |

## When to Use Actions

Use actions instead of mutations when you need to:

- Call external APIs (payment processors, email services, AI APIs)
- Perform non-deterministic operations (random values, current time)
- Run long-running computations
- Access Node.js APIs or npm packages

```ts
// convex/actions.ts
export const sendEmail = action({
  args: { to: v.string(), subject: v.string(), body: v.string() },
  handler: async (ctx, args) => {
    // Call external email API
    const response = await fetch('https://api.email.com/send', {
      method: 'POST',
      body: JSON.stringify(args),
    })
    return response.ok
  },
})
```

## Usage Examples

### Basic Action

```ts
const { execute, pending, error } = useConvexAction(api.email.send)

async function handleSendEmail() {
  try {
    await execute({
      to: 'user@example.com',
      subject: 'Hello',
      body: 'Welcome!',
    })
  } catch (err) {
    console.error('Failed to send:', err)
  }
}
```

### With Status Tracking

```vue
<script setup lang="ts">
const { execute, pending, data, error } = useConvexAction(api.ai.generate)

const prompt = ref('')
</script>

<template>
  <form @submit.prevent="execute({ prompt })">
    <textarea v-model="prompt" />
    <button :disabled="pending">
      {{ pending ? 'Generating...' : 'Generate' }}
    </button>
  </form>

  <div v-if="data">
    <h3>Result:</h3>
    <p>{{ data }}</p>
  </div>

  <div v-if="error">
    Error: {{ error.message }}
  </div>
</template>
```

### Payment Processing

```ts
const { execute: processPayment, pending } = useConvexAction(api.payments.process)

async function handleCheckout() {
  const result = await processPayment({
    amount: 2999, // $29.99 in cents
    paymentMethodId: selectedMethod.value,
  })

  if (result.success) {
    navigateTo('/order-confirmation')
  }
}
```

### AI Integration

```ts
const { execute, pending, data } = useConvexAction(api.ai.summarize)

async function handleSummarize(articleId: string) {
  const summary = await execute({ articleId })
  // summary is the AI-generated text
}
```

### File Processing

```ts
const { execute, pending } = useConvexAction(api.files.processImage)

async function handleUpload(storageId: Id<'_storage'>) {
  // Process image (resize, optimize, etc.)
  const result = await execute({ storageId })
  // result contains processed image info
}
```

## Actions vs Mutations

| Feature | Mutations | Actions |
|---------|-----------|---------|
| External APIs | No | Yes |
| Database writes | Yes (transactional) | Via internal mutations |
| Deterministic | Required | Not required |
| Optimistic updates | Supported | Not supported |
| Retries | Automatic | Manual |
| Timeout | Short | Longer |

**Use mutations** for database operations. **Use actions** for everything else.

## Error Handling

```ts
const { execute, error } = useConvexAction(api.payments.process)

async function handlePayment() {
  try {
    await execute({ amount: 1000 })
  } catch (err) {
    if (err.message.includes('insufficient_funds')) {
      showError('Your card was declined')
    } else {
      showError('Payment failed. Please try again.')
    }
  }
}
```

## TypeScript

Fully typed based on your action definition:

```ts
// If api.ai.generate has args { prompt: string }
// and returns { text: string, tokens: number }

const { execute, data } = useConvexAction(api.ai.generate)

const result = await execute({ prompt: 'Hello' }) // âœ“
// result: { text: string, tokens: number }

// data is Ref<{ text: string, tokens: number } | undefined>
```

## Notes

- Actions don't support optimistic updates (results aren't predictable)
- Actions can take longer than mutations (different timeout limits)
- Actions can call mutations internally for database writes
- Long-running actions should consider timeout limits
- Actions run in a Node.js environment on Convex's servers

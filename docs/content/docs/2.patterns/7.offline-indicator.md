---
title: Offline Indicator
description: Show connection state to your users.
navigation:
  icon: i-lucide-wifi-off
---

Real-time apps need network connections. When that connection breaks, users should know. Here's how to show them.

## Basic Status

Use `useConvexConnectionState` to get connection info:

```vue
<script setup lang="ts">
const { isConnected, isReconnecting } = useConvexConnectionState()
</script>

<template>
  <div v-if="!isConnected" class="offline-banner">
    <span v-if="isReconnecting">Reconnecting...</span>
    <span v-else>You're offline</span>
  </div>
</template>
```

## Available States

The composable returns several useful refs:

| Property | Type | Description |
|----------|------|-------------|
| `isConnected` | `boolean` | WebSocket is connected |
| `hasEverConnected` | `boolean` | Connected at least once this session |
| `isReconnecting` | `boolean` | Actively trying to reconnect |
| `connectionRetries` | `number` | Number of retry attempts |
| `inflightMutations` | `number` | Mutations waiting for response |
| `inflightActions` | `number` | Actions waiting for response |

## Offline Banner

A banner that slides in when disconnected:

```vue
<script setup lang="ts">
const { isConnected, isReconnecting, connectionRetries } = useConvexConnectionState()
</script>

<template>
  <Transition name="slide">
    <div v-if="!isConnected" class="offline-banner">
      <div class="content">
        <span class="icon">
          <svg><!-- wifi-off icon --></svg>
        </span>

        <span v-if="isReconnecting">
          Reconnecting{{ connectionRetries > 1 ? ` (attempt ${connectionRetries})` : '' }}...
        </span>
        <span v-else>
          You're offline. Changes will sync when you reconnect.
        </span>
      </div>
    </div>
  </Transition>
</template>

<style scoped>
.offline-banner {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: #f59e0b;
  color: white;
  padding: 0.75rem 1rem;
  z-index: 50;
}

.content {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  max-width: 1200px;
  margin: 0 auto;
}

.slide-enter-active,
.slide-leave-active {
  transition: transform 0.3s ease;
}

.slide-enter-from,
.slide-leave-to {
  transform: translateY(100%);
}
</style>
```

## Connection Dot

A subtle indicator in the corner:

```vue
<script setup lang="ts">
const { isConnected, isReconnecting } = useConvexConnectionState()

const statusColor = computed(() => {
  if (isConnected.value) return 'bg-green-500'
  if (isReconnecting.value) return 'bg-yellow-500'
  return 'bg-red-500'
})

const statusText = computed(() => {
  if (isConnected.value) return 'Connected'
  if (isReconnecting.value) return 'Reconnecting'
  return 'Offline'
})
</script>

<template>
  <div class="connection-status" :title="statusText">
    <span class="dot" :class="statusColor" />
  </div>
</template>

<style scoped>
.connection-status {
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

.dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.bg-green-500 { background: #22c55e; }
.bg-yellow-500 { background: #eab308; }
.bg-red-500 { background: #ef4444; }
</style>
```

## Pending Changes Indicator

Show users when mutations are in flight:

```vue
<script setup lang="ts">
const { inflightMutations, isConnected } = useConvexConnectionState()

const hasPending = computed(() => inflightMutations.value > 0)
</script>

<template>
  <div v-if="hasPending && !isConnected" class="pending-badge">
    {{ inflightMutations }} pending change{{ inflightMutations > 1 ? 's' : '' }}
  </div>
</template>
```

This helps users understand why their changes aren't showing up yet.

## First Load State

Sometimes you want to know if you've ever connected. Useful for distinguishing "loading" from "offline":

```vue
<script setup lang="ts">
const { isConnected, hasEverConnected } = useConvexConnectionState()
const { data, status } = await useConvexQuery(api.posts.list, {})
</script>

<template>
  <!-- Never connected: probably still loading -->
  <div v-if="status === 'pending' && !hasEverConnected">
    <LoadingSpinner />
  </div>

  <!-- Was connected, now offline -->
  <div v-else-if="!isConnected && hasEverConnected">
    <OfflineBanner />
    <!-- Still show stale data -->
    <PostList :posts="data" />
  </div>

  <!-- Connected and good -->
  <div v-else>
    <PostList :posts="data" />
  </div>
</template>
```

## Global Component

Create a component to add to your layout:

```vue [app/components/ConnectionStatus.vue]
<script setup lang="ts">
const { isConnected, isReconnecting, connectionRetries, inflightMutations } =
  useConvexConnectionState()

// Show banner only after a short delay (avoid flashing during quick reconnects)
const showBanner = ref(false)
let timeout: NodeJS.Timeout

watch(isConnected, (connected) => {
  clearTimeout(timeout)
  if (!connected) {
    timeout = setTimeout(() => {
      showBanner.value = true
    }, 2000) // 2 second grace period
  } else {
    showBanner.value = false
  }
})
</script>

<template>
  <Teleport to="body">
    <Transition name="slide">
      <div v-if="showBanner" class="connection-banner">
        <div v-if="isReconnecting">
          Reconnecting to server...
          <span v-if="connectionRetries > 2">(attempt {{ connectionRetries }})</span>
        </div>
        <div v-else>
          No connection. Your changes will sync when you're back online.
        </div>
        <div v-if="inflightMutations > 0" class="pending">
          {{ inflightMutations }} unsaved change{{ inflightMutations > 1 ? 's' : '' }}
        </div>
      </div>
    </Transition>
  </Teleport>
</template>
```

Use it in your layout:

```vue [app/layouts/default.vue]
<template>
  <div>
    <Header />
    <main>
      <slot />
    </main>
    <Footer />
    <ConnectionStatus />
  </div>
</template>
```

## Toast Notifications

For a less intrusive approach, use toasts:

```vue
<script setup lang="ts">
const { isConnected } = useConvexConnectionState()
const toast = useToast() // your toast library

watch(isConnected, (connected, wasConnected) => {
  if (!connected && wasConnected) {
    toast.warning('You appear to be offline')
  }
  if (connected && !wasConnected) {
    toast.success('Back online!')
  }
})
</script>
```

## Testing Offline

To test your offline UI:

1. Open DevTools → Network tab
2. Select "Offline" from the throttling dropdown
3. Watch your indicator appear
4. Go back online
5. Watch it disappear

Or in Chrome DevTools → Application → Service Workers → check "Offline".

The WebSocket will disconnect, triggering your offline state. When you restore the connection, Convex automatically reconnects and resyncs.
